"use strict";(self["webpackChunkbmi_app_gen"]=self["webpackChunkbmi_app_gen"]||[]).push([[140],{1140:function(e,a,l){l.r(a),l.d(a,{default:function(){return G}});var t=l(6768),s=l(4232);const r={class:"export-page"},i={key:0,class:"status"},o={key:1,class:"status error"},n={key:2,class:"ready"},k={class:"meta"},y={class:"actions"},b=["disabled"];function c(e,a,l,c,d,m){const _=(0,t.g2)("OneSheetExport");return(0,t.uX)(),(0,t.CE)("div",r,[a[5]||(a[5]=(0,t.Lk)("header",{class:"top"},[(0,t.Lk)("h2",null,"Export Medical Record"),(0,t.Lk)("div",{style:{height:"1rem"}})],-1)),d.busy?((0,t.uX)(),(0,t.CE)("section",i," Preparing data… please wait. ")):d.loadError?((0,t.uX)(),(0,t.CE)("section",o," Failed to load: "+(0,s.v_)(d.loadError),1)):((0,t.uX)(),(0,t.CE)("section",n,a[2]||(a[2]=[(0,t.Lk)("p",null,'Data is ready. Click "Export" button below to download.',-1)]))),(0,t.Lk)("div",k,[(0,t.Lk)("div",null,[a[3]||(a[3]=(0,t.eW)("Session: ")),(0,t.Lk)("strong",null,(0,s.v_)(d.sessionId||"—"),1)]),(0,t.Lk)("div",null,[a[4]||(a[4]=(0,t.eW)("Staff: ")),(0,t.Lk)("strong",null,(0,s.v_)(d.staffEmail||"—"),1)])]),(0,t.Lk)("div",y,[(0,t.Lk)("button",{disabled:d.busy,onClick:a[0]||(a[0]=(...e)=>m.reload&&m.reload(...e))},(0,s.v_)(d.busy?"Loading…":"Reload"),9,b),(0,t.Lk)("button",{onClick:a[1]||(a[1]=a=>e.$router.back())},"Back")]),(0,t.bF)(_,{ref:"oneSheet",sections:m.sections,filename:`medical-record-${d.staffEmail}.xlsx`,title:"Export medical record (one sheet)"},null,8,["sections","filename"])])}l(8111),l(7588);var d=l(5130);const m=["disabled"],_={class:"export-dialog"},u={class:"sections"},h={class:"sec-head"},p={class:"include"},f=["onUpdate:modelValue"],g={class:"badge"},R=["open"],D={key:0,class:"cols kv"},A=["value","onUpdate:modelValue"],C={key:1,class:"cols table"},v=["value","onUpdate:modelValue"],E={class:"row-actions"},S=["onClick"],w=["onClick"],L={class:"dialog-actions"},U=["disabled"];function B(e,a,l,r,i,o){return(0,t.uX)(),(0,t.CE)(t.FK,null,[(0,t.RG)(e.$slots,"trigger",{open:o.open,disabled:!o.hasAnyRows},(()=>[(0,t.Lk)("button",{disabled:!o.hasAnyRows,onClick:a[0]||(a[0]=(...e)=>o.open&&o.open(...e))},"Export Excel (One Sheet)",8,m)]),!0),i.show?((0,t.uX)(),(0,t.CE)("div",{key:0,class:"export-backdrop",onClick:a[5]||(a[5]=(0,d.D$)(((...e)=>o.close&&o.close(...e)),["self"]))},[(0,t.Lk)("div",_,[(0,t.Lk)("h3",null,(0,s.v_)(l.title||"Export to one Excel sheet"),1),(0,t.Lk)("div",u,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(o.normalizedSections,((e,l)=>((0,t.uX)(),(0,t.CE)("div",{key:e._id,class:"sec-card"},[(0,t.Lk)("div",h,[(0,t.Lk)("label",p,[(0,t.bo)((0,t.Lk)("input",{type:"checkbox","onUpdate:modelValue":e=>i.state[l].included=e},null,8,f),[[d.lH,i.state[l].included]]),(0,t.Lk)("strong",null,(0,s.v_)(e.title),1),(0,t.Lk)("span",g,(0,s.v_)(e.kind.toUpperCase()),1)])]),(0,t.Lk)("details",{class:"cols-wrap",open:o.normalizedSections.length<=3},[a[6]||(a[6]=(0,t.Lk)("summary",null,"Columns",-1)),"kv"===e.kind?((0,t.uX)(),(0,t.CE)("div",D,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.columns,((e,a)=>((0,t.uX)(),(0,t.CE)("label",{key:e.key??a,class:"col-item"},[(0,t.bo)((0,t.Lk)("input",{type:"checkbox",value:e.key,"onUpdate:modelValue":e=>i.state[l].selectedKeys=e},null,8,A),[[d.lH,i.state[l].selectedKeys]]),(0,t.eW)(" "+(0,s.v_)(e.label),1)])))),128))])):((0,t.uX)(),(0,t.CE)("div",C,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.columns,((e,a)=>((0,t.uX)(),(0,t.CE)("label",{key:e.key??a,class:"col-item"},[(0,t.bo)((0,t.Lk)("input",{type:"checkbox",value:e.key,"onUpdate:modelValue":e=>i.state[l].selectedKeys=e},null,8,v),[[d.lH,i.state[l].selectedKeys]]),(0,t.eW)(" "+(0,s.v_)(e.label),1)])))),128))])),(0,t.Lk)("div",E,[(0,t.Lk)("button",{type:"button",onClick:e=>o.selectAllCols(l)},"Select all",8,S),(0,t.Lk)("button",{type:"button",onClick:e=>o.clearCols(l)},"Clear",8,w)])],8,R)])))),128))]),(0,t.Lk)("div",L,[(0,t.Lk)("button",{type:"button",onClick:a[1]||(a[1]=(...e)=>o.includeAll&&o.includeAll(...e))},"Include all"),(0,t.Lk)("button",{type:"button",onClick:a[2]||(a[2]=(...e)=>o.excludeAll&&o.excludeAll(...e))},"Exclude all"),a[7]||(a[7]=(0,t.Lk)("div",{class:"spacer"},null,-1)),(0,t.Lk)("button",{type:"button",onClick:a[3]||(a[3]=(...e)=>o.close&&o.close(...e))},"Cancel"),(0,t.Lk)("button",{type:"button",disabled:!o.canExport,onClick:a[4]||(a[4]=(...e)=>o.exportNow&&o.exportNow(...e))},"Export",8,U)])])])):(0,t.Q3)("",!0)],64)}l(4114),l(2489),l(1701),l(3579);var H=l(3230),x={name:"OneSheetExport",props:{sections:{type:Array,default:()=>[]},filename:{type:String,default:""},title:{type:String,default:""}},data(){return{show:!1,state:[]}},computed:{normalizedSections(){return(Array.isArray(this.sections)?this.sections:[]).map(((e,a)=>({_id:e.id||`sec-${a}`,title:e.title||`Section ${a+1}`,kind:"table"===e.kind?"table":"kv",data:e.data,columns:Array.isArray(e.columns)?e.columns:[],defaultSelectedKeys:Array.isArray(e.defaultSelectedKeys)?e.defaultSelectedKeys:null})))},hasAnyRows(){return this.normalizedSections.some((e=>"kv"===e.kind?!!e.data&&"object"===typeof e.data:"table"===e.kind&&(Array.isArray(e.data)&&e.data.length>0)))},canExport(){return this.normalizedSections.some(((e,a)=>{const l=this.state[a];return l?.included&&l.selectedKeys?.length>0}))}},watch:{normalizedSections:{immediate:!0,handler(e){this.state=e.map((e=>{const a=e.defaultSelectedKeys&&e.defaultSelectedKeys.length?[...e.defaultSelectedKeys]:e.columns.map((e=>e.key)).filter((e=>!(e?.endsWith("created_at")||e?.endsWith("updated_at")||/(^|_)created_at$/.test(e)||/(^|_)updated_at$/.test(e))));return{included:!0,selectedKeys:a}}))}}},methods:{open(){this.show=!0},close(){this.show=!1},includeAll(){this.state.forEach((e=>e.included=!0))},excludeAll(){this.state.forEach((e=>e.included=!1))},selectAllCols(e){const a=this.normalizedSections[e]?.columns||[];this.state[e].selectedKeys=a.map((e=>e.key))},clearCols(e){this.state[e].selectedKeys=[]},_valueFor(e,a){const l=e.getter?e.getter(a):a?.[e.key];return e.format?e.format(l,a):l??""},exportNow(){try{const e=H.utils.book_new(),a=H.utils.aoa_to_sheet([]);let l=0;const t=(e=1)=>{l+=e},s=e=>{H.utils.sheet_add_aoa(a,[[e]],{origin:{r:l,c:0}});const t=H.utils.encode_cell({r:l,c:0});a[t]||(a[t]={t:"s",v:e}),a[t].s={font:{bold:!0}},l+=1},r=(e,r)=>{s(e.title);const i=[];r.forEach((a=>{i.push([a.label,this._valueFor(a,e.data)])})),H.utils.sheet_add_aoa(a,i,{origin:{r:l,c:0}}),l+=i.length,t(1)},i=(e,r)=>{s(e.title);const i=r.map((e=>e.label));H.utils.sheet_add_aoa(a,[i],{origin:{r:l,c:0}}),l+=1;const o=(e.data||[]).map((e=>r.map((a=>this._valueFor(a,e)))));o.length&&(H.utils.sheet_add_aoa(a,o,{origin:{r:l,c:0}}),l+=o.length),t(1)};this.normalizedSections.forEach(((e,a)=>{const l=this.state[a];if(!l?.included)return;const t=e.columns.filter((e=>l.selectedKeys.includes(e.key)));t.length&&("kv"===e.kind?r(e,t):i(e,t))}));const o=a["!ref"];if(o){const e=H.utils.decode_range(o),l=Array.from({length:e.e.c-e.s.c+1},(()=>({wch:10})));for(let t=e.s.c;t<=e.e.c;t++){let s=10;for(let l=e.s.r;l<=e.e.r;l++){const e=a[H.utils.encode_cell({r:l,c:t})];if(e&&null!=e.v){const a=String(e.v).length;a+2>s&&(s=Math.min(a+2,60))}}l[t]={wch:s}}a["!cols"]=l}H.utils.book_append_sheet(e,a,"Report");const n=this.filename||`report-${(new Date).toISOString().slice(0,10)}.xlsx`;H.writeFile(e,n),this.close()}catch(e){console.error("OneSheet export failed:",e),alert("Export failed. Check console for details.")}}}},F=l(1241);const P=(0,F.A)(x,[["render",B],["__scopeId","data-v-faae8e84"]]);var I=P,$=l(8945),z=l(1585);const N=e=>!0===e?"Yes":!1===e?"No":e??"",T=e=>e??"";var j={name:"ExportMedicalRecord",components:{OneSheetExport:I},data(){return{baseUrl:$.A.API_BASE_URL,busy:!1,loadError:"",sessionId:null,staffEmail:null,personalInfo:null,occupationalRows:[],familyRows:[],famDisease:null,medicalHistory:null,medicalFields:[{key:"abnormal_heartbeat",label:"Abnormal Heartbeat"},{key:"bladder_trouble",label:"Bladder Trouble"},{key:"dermatitis_eczema",label:"Dermatitis / Eczema"},{key:"depression",label:"Depression"},{key:"heart_murmur",label:"Heart Murmur"},{key:"hernia",label:"Hernia"},{key:"jaundice",label:"Jaundice"},{key:"kidney_disease",label:"Kidney Disease"},{key:"peptic_ulcer",label:"Peptic Ulcer"},{key:"persistent_night_sweats",label:"Persistent Night Sweats"},{key:"rectal_bleeding",label:"Rectal Bleeding"},{key:"unintentional_weight_loss",label:"Unintentional Weight Loss"},{key:"asthma_bronchitis",label:"Asthma / Bronchitis"},{key:"bowel_disorder",label:"Bowel Disorder"},{key:"diabetes",label:"Diabetes"},{key:"frequent_indigestion",label:"Frequent Indigestion"},{key:"high_blood_pressure",label:"High Blood Pressure"},{key:"hospitalisation_surgery",label:"Hospitalisation / Surgery"},{key:"migraine_headache",label:"Migraine / Headache"},{key:"psoriasis_skin_disease",label:"Psoriasis / Skin Disease"},{key:"persistent_diarrhoea",label:"Persistent Diarrhoea"},{key:"renal_colic_stone",label:"Renal Colic / Stone"},{key:"swollen_lymph_glands",label:"Swollen Lymph Glands"},{key:"anxiety",label:"Anxiety"},{key:"blood_in_urine",label:"Blood in Urine"},{key:"dizziness_giddiness",label:"Dizziness / Giddiness"},{key:"faints_blackouts",label:"Faints / Blackouts"},{key:"hay_fever",label:"Hay Fever"},{key:"joint_disorder",label:"Joint Disorder"},{key:"liver_gall_bladder",label:"Liver / Gall / Bladder"},{key:"piles_haemorrhoids",label:"Piles / Haemorrhoids"},{key:"rheumatic_fever",label:"Rheumatic Fever"},{key:"std",label:"STD"},{key:"tuberculosis",label:"Tuberculosis"},{key:"none_of_the_above",label:"None of the Above"}],lifestyle:null,pe1:null,pe2:null,inv:null,lab:null}},computed:{sections(){const e=[{key:"staff_name",label:"Name"},{key:"staff_email",label:"Email"},{key:"staff_no",label:"Staff No"},{key:"job_title",label:"Job Title / Position"},{key:"department",label:"Department"},{key:"marital_status",label:"Marital Status"},{key:"sex",label:"Sex"},{key:"date_of_birth",label:"Date of Birth",format:T},{key:"ic_passport",label:"IC/Passport"},{key:"nationality",label:"Nationality"},{key:"phone_no",label:"Phone"},{key:"address",label:"Address"},{key:"personal_doctor_email",label:"Personal Doctor Email"},{key:"doctor_phone_no",label:"Doctor Phone"},{key:"reason_for_examination",label:"Reason"},{key:"date_of_this_assessment",label:"Date of This Assessment",format:T},{key:"date_of_last_assessment",label:"Date of Last Assessment",format:T},{key:"created_at",label:"Created At",format:T},{key:"updated_at",label:"Updated At",format:T}],a=[{key:"year",label:"Year"},{key:"company",label:"Company"},{key:"location",label:"Location"},{key:"job_title",label:"Job Title"},{key:"nature_of_work",label:"Nature of Work"}],l=[{key:"relationship",label:"Relationship"},{key:"relative_name",label:"Name"},{key:"sex",label:"Sex"},{key:"year_of_born",label:"Year of Birth"},{key:"age_now",label:"Age Now"},{key:"age_at_death",label:"Age at Death"},{key:"state_health_death_cause",label:"State of Health / Cause of Death"},{key:"updated_at",label:"Updated At",format:T}],t=[{key:"heart_disease",label:"Heart Disease",format:N},{key:"high_blood_pressure",label:"High Blood Pressure",format:N},{key:"stroke",label:"Stroke",format:N},{key:"cancer",label:"Cancer",format:N},{key:"diabetes",label:"Diabetes",format:N},{key:"kidney_disease",label:"Kidney Disease",format:N},{key:"allergy",label:"Allergy",format:N},{key:"asthma",label:"Asthma",format:N},{key:"eczema",label:"Eczema",format:N},{key:"tuberculosis",label:"Tuberculosis",format:N},{key:"epilepsy",label:"Epilepsy",format:N},{key:"mental_disorder",label:"Mental Disorder",format:N},{key:"alcohol_dependence",label:"Alcohol Dependence",format:N},{key:"drug_abuse",label:"Drug Abuse",format:N},{key:"birth_abnormality",label:"Birth Abnormality",format:N},{key:"details",label:"Details"},{key:"created_at",label:"Created At",format:T},{key:"updated_at",label:"Updated At",format:T}],s=[{key:"abnormal_heartbeat",label:"Abnormal heartbeat",format:N},{key:"abnormal_heartbeat",label:"Abnormal heartbeat",format:N},{key:"bladder_trouble",label:"Bladder trouble",format:N},{key:"dermatitis_eczema",label:"Dermatitis/Eczema",format:N},{key:"depression",label:"Depression",format:N},{key:"heart_murmur",label:"Heart Murmur",format:N},{key:"hernia",label:"Hernia",format:N},{key:"jaundice",label:"Jaundice",format:N},{key:"kidney_disease",label:"Kidney Disease",format:N},{key:"peptic_ulcer",label:"Peptic Ulcer",format:N},{key:"persistent_night_sweats",label:"Persistent Night Sweats",format:N},{key:"rectal_bleeding",label:"Rectal Bleeding",format:N},{key:"unintentional_weight_loss",label:"Unintentional Weight Loss",format:N},{key:"asthma_bronchitis",label:"Asthma/Bronchitis",format:N},{key:"bowel_disorder",label:"Bowel Disorder",format:N},{key:"diabetes",label:"Diabetes",format:N},{key:"frequent_indigestion",label:"Frequent Indigestion",format:N},{key:"high_blood_pressure",label:"High Blood Pressure",format:N},{key:"hospitalisation_surgery",label:"Hospitalisation/Surgery",format:N},{key:"migraine_headache",label:"Migraine Headache",format:N},{key:"psoriasis_skin_disease",label:"Psoriasis Skin Disease",format:N},{key:"persistent_diarrhoea",label:"Persistent Diarrhoea",format:N},{key:"renal_colic_stone",label:"Renal Colic Stone",format:N},{key:"swollen_lymph_glands",label:"Swollen Lymph Glands",format:N},{key:"anxiety",label:"Anxiety",format:N},{key:"blood_in_urine",label:"Blood in Urine",format:N},{key:"dizziness_giddiness",label:"Dizziness/Giddiness",format:N},{key:"faints_blackouts",label:"Faints/Blackouts",format:N},{key:"hay_fever",label:"Hay Fever",format:N},{key:"joint_disorder",label:"Joint Disorder",format:N},{key:"liver_gall_bladder",label:"Liver Gall Bladder",format:N},{key:"piles_haemorrhoids",label:"Piles/Haemorrhoids",format:N},{key:"rheumatic_fever",label:"Rheumatic Fever",format:N},{key:"std",label:"STD",format:N},{key:"tuberculosis",label:"Tuberculosis",format:N},{key:"none_of_the_above",label:"None of the above",format:N},{key:"comment_by_examine_doctor",label:"Doctor Comment"},{key:"created_at",label:"Created At",format:T}],r=[{key:"smoking_habit",label:"Smoking Habit"},{key:"years_smoked",label:"Years Smoked"},{key:"amount_smoke_day",label:"Amount/Day"},{key:"date_stopped",label:"Date Stopped",format:T},{key:"alcohol_drink",label:"Alcohol Drink"},{key:"drink_per_week",label:"Drinks/Week"},{key:"taking_prescribed_drugs",label:"Taking Prescribed Drugs"},{key:"drug_detail",label:"Drug Detail"},{key:"declaration_consent",label:"Consent",format:N},{key:"consent_signer_name",label:"Consent Signer"},{key:"consent_signer_date",label:"Consent Date",format:T},{key:"created_at",label:"Created At",format:T},{key:"updated_at",label:"Updated At",format:T}],i=[{key:"pe_id",label:"PE ID"},{key:"staff_email",label:"Staff Email"},{key:"session_id",label:"Session ID"},{key:"weight_kg",label:"Weight (kg)"},{key:"height_m",label:"Height (m)"},{key:"bmi",label:"BMI"},{key:"bp_sys",label:"BP Systolic"},{key:"bp_dia",label:"BP Diastolic"},{key:"pulse_bpm",label:"Pulse (bpm)"},{key:"blood_group",label:"Blood Group"},{key:"dist_uncorr_r",label:"Distance Uncorrected Right Eye"},{key:"dist_uncorr_l",label:"Distance Uncorrected Left Eye"},{key:"dist_uncorr_b",label:"Distance Uncorrected Both Eyes"},{key:"dist_corr_r",label:"Distance Corrected Right Eye"},{key:"dist_corr_l",label:"Distance Corrected Left Eye"},{key:"dist_corr_b",label:"Distance Corrected Both Eyes"},{key:"near_uncorr_r",label:"Near Uncorrected Right Eye"},{key:"near_uncorr_l",label:"Near Uncorrected Left Eye"},{key:"near_uncorr_b",label:"Near Uncorrected Both Eyes"},{key:"near_corr_r",label:"Near Corrected Right Eye"},{key:"near_corr_l",label:"Near Corrected Left Eye"},{key:"near_corr_b",label:"Near Corrected Both Eyes"},{key:"colour_vision",label:"Colour Vision"},{key:"created_at",label:"Created At",format:T},{key:"updated_at",label:"Updated At",format:T}],o=[{key:"pe2_id",label:"PE2 ID"},{key:"staff_email",label:"Staff Email"},{key:"session_id",label:"Session ID"},{key:"head",label:"Head"},{key:"head_details_abnormality",label:"Head Details"},{key:"eyes",label:"Eyes"},{key:"eyes_details_abnormality",label:"Eyes Details"},{key:"ears_and_drums",label:"Ears and Drums"},{key:"ears_and_drums_details_abnormality",label:"Ears and Drums Details"},{key:"hearing",label:"Hearing"},{key:"hearing_details_abnormality",label:"Hearing Details"},{key:"nose_and_sinuses",label:"Nose and Sinuses"},{key:"nose_and_sinuses_details_abnormality",label:"Nose and Sinuses Details"},{key:"mouth_teeth_throat",label:"Mouth, Teeth, Throat"},{key:"mouth_teeth_throat_details_abnormality",label:"Mouth, Teeth, Throat Details"},{key:"neck_and_thyroid",label:"Neck and Thyroid"},{key:"neck_and_thyroid_details_abnormality",label:"Neck and Thyroid Details"},{key:"chest_and_lungs",label:"Chest and Lungs"},{key:"chest_and_lungs_details_abnormality",label:"Chest and Lungs Details"},{key:"breasts",label:"Breasts"},{key:"breasts_details_abnormality",label:"Breasts Details"},{key:"heart",label:"Heart"},{key:"heart_details_abnormality",label:"Heart Details"},{key:"peripheral_arteries",label:"Peripheral Arteries"},{key:"peripheral_arteries_details_abnormality",label:"Peripheral Arteries Details"},{key:"peripheral_veins",label:"Peripheral Veins"},{key:"peripheral_veins_details_abnormality",label:"Peripheral Veins Details"},{key:"abdomen",label:"Abdomen"},{key:"abdomen_details_abnormality",label:"Abdomen Details"},{key:"hernia_orifices",label:"Hernia Orifices"},{key:"hernia_orifices_details_abnormality",label:"Hernia Orifices Details"},{key:"genitalia",label:"Genitalia"},{key:"genitalia_details_abnormality",label:"Genitalia Details"},{key:"rectal_examination",label:"Rectal Examination"},{key:"rectal_examination_details_abnormality",label:"Rectal Examination Details"},{key:"upper_limbs",label:"Upper Limbs"},{key:"upper_limbs_details_abnormality",label:"Upper Limbs Details"},{key:"lower_limbs",label:"Lower Limbs"},{key:"lower_limbs_details_abnormality",label:"Lower Limbs Details"},{key:"spine",label:"Spine"},{key:"spine_details_abnormality",label:"Spine Details"},{key:"skin",label:"Skin"},{key:"skin_details_abnormality",label:"Skin Details"},{key:"lymph_nodes",label:"Lymph Nodes"},{key:"lymph_nodes_details_abnormality",label:"Lymph Nodes Details"},{key:"neurological",label:"Neurological"},{key:"neurological_details_abnormality",label:"Neurological Details"},{key:"psychiatric",label:"Psychiatric"},{key:"psychiatric_details_abnormality",label:"Psychiatric Details"},{key:"created_at",label:"Created At",format:T},{key:"updated_at",label:"Updated At",format:T}],n=[{key:"inv_id",label:"Inv ID"},{key:"staff_email",label:"Staff Email"},{key:"session_id",label:"Session ID"},{key:"spirometry_status",label:"Spirometry Status"},{key:"spirometry_details",label:"Spirometry Details"},{key:"audiometry_status",label:"Audiometry Status"},{key:"audiometry_details",label:"Audiometry Details"},{key:"chest_xray_status",label:"Chest Xray Status"},{key:"chest_xray_details",label:"Chest Xray Details"},{key:"electrocardiograph_status",label:"Electrocardiograph Status"},{key:"electrocardiograph_details",label:"Electrocardiograph Details"},{key:"opiates_result",label:"Opiates Result"},{key:"opiates_remark",label:"Opiates Remark"},{key:"cannabinoids_result",label:"Cannabinoids Result"},{key:"cannabinoids_remark",label:"Cannabinoids Remark"},{key:"amphetamine_result",label:"Amphetamine Result"},{key:"amphetamine_remark",label:"Amphetamine Remark"},{key:"mdma_result",label:"MDMA Result"},{key:"mdma_remark",label:"MDMA Remark"},{key:"benzodiazepine_result",label:"Benzodiazepine Result"},{key:"benzodiazepine_remark",label:"Benzodiazepine Remark"},{key:"remarks_ohd",label:"Remarks by Examine Doctor"},{key:"created_at",label:"Created At",format:T},{key:"updated_at",label:"Updated At",format:T}],k=[{key:"ilab_id",label:"ILAB ID"},{key:"staff_email",label:"Staff Email"},{key:"session_id",label:"Session ID"},{key:"hb_result",label:"Hb Result"},{key:"hb_remark",label:"Hb Remark"},{key:"rbc_result",label:"RBC Result"},{key:"rbc_remark",label:"RBC Remark"},{key:"pcv_result",label:"PCV Result"},{key:"pcv_remark",label:"PCV Remark"},{key:"mcv_result",label:"MCV Result"},{key:"mcv_remark",label:"MCV Remark"},{key:"mch_result",label:"MCH Result"},{key:"mch_remark",label:"MCH Remark"},{key:"mchc_result",label:"MCHC Result"},{key:"mchc_remark",label:"MCHC Remark"},{key:"rdw_result",label:"RDW Result"},{key:"rdw_remark",label:"RDW Remark"},{key:"wbc_result",label:"WBC Result"},{key:"wbc_remark",label:"WBC Remark"},{key:"neut_result",label:"Neut Result"},{key:"neut_remark",label:"Neut Remark"},{key:"lym_result",label:"Lym Result"},{key:"lym_remark",label:"Lym Remark"},{key:"mon_result",label:"Mon Result"},{key:"mon_remark",label:"Mon Remark"},{key:"eon_result",label:"Eon Result"},{key:"eon_remark",label:"Eon Remark"},{key:"bas_result",label:"Bas Result"},{key:"bas_remark",label:"Bas Remark"},{key:"plet_result",label:"Plet Result"},{key:"plet_remark",label:"Plet Remark"},{key:"esr_result",label:"ESR Result"},{key:"esr_remark",label:"ESR Remark"},{key:"fbp_result",label:"FBP Result"},{key:"fbp_remark",label:"FBP Remark"},{key:"fbs_result",label:"FBS Result"},{key:"fbs_remark",label:"FBS Remark"},{key:"rbs_result",label:"RBS Result"},{key:"rbs_remark",label:"RBS Remark"},{key:"tchol_result",label:"Tchol Result"},{key:"tchol_remark",label:"Tchol Remark"},{key:"tg_result",label:"TG Result"},{key:"tg_remark",label:"TG Remark"},{key:"hdl_result",label:"HDL Result"},{key:"hdl_remark",label:"HDL Remark"},{key:"ldl_result",label:"LDL Result"},{key:"ldl_remark",label:"LDL Remark"},{key:"na_result",label:"Na Result"},{key:"na_remark",label:"Na Remark"},{key:"k_result",label:"K Result"},{key:"k_remark",label:"K Remark"},{key:"cl_result",label:"Cl Result"},{key:"cl_remark",label:"Cl Remark"},{key:"bu_result",label:"BU Result"},{key:"bu_remark",label:"BU Remark"},{key:"creat_result",label:"Creat Result"},{key:"creat_remark",label:"Creat Remark"},{key:"ua_result",label:"UA Result"},{key:"ua_remark",label:"UA Remark"},{key:"ca_result",label:"Ca Result"},{key:"ca_remark",label:"Ca Remark"},{key:"cca_result",label:"Cca Result"},{key:"cca_remark",label:"Cca Remark"},{key:"po4_result",label:"PO4 Result"},{key:"po4_remark",label:"PO4 Remark"},{key:"tprot_result",label:"Tprot Result"},{key:"tprot_remark",label:"Tprot Remark"},{key:"alb_result",label:"Alb Result"},{key:"alb_remark",label:"Alb Remark"},{key:"glo_result",label:"Glo Result"},{key:"glo_remark",label:"Glo Remark"},{key:"agr_result",label:"AGR Result"},{key:"agr_remark",label:"AGR Remark"},{key:"alkp_result",label:"AlkP Result"},{key:"alkp_remark",label:"AlkP Remark"},{key:"tbil_result",label:"Tbil Result"},{key:"tbil_remark",label:"Tbil Remark"},{key:"ggt_result",label:"GGT Result"},{key:"ggt_remark",label:"GGT Remark"},{key:"ast_result",label:"AST Result"},{key:"ast_remark",label:"AST Remark"},{key:"alt_result",label:"ALT Result"},{key:"alt_remark",label:"ALT Remark"},{key:"uprot_result",label:"Uprot Result"},{key:"uprot_remark",label:"Uprot Remark"},{key:"uph_result",label:"UpH Result"},{key:"uph_remark",label:"UpH Remark"},{key:"uglu_result",label:"Uglu Result"},{key:"uglu_remark",label:"Uglu Remark"},{key:"uket_result",label:"Uket Result"},{key:"uket_remark",label:"Uket Remark"},{key:"usg_result",label:"USG Result"},{key:"usg_remark",label:"USG Remark"},{key:"ubld_result",label:"Ubld Result"},{key:"ubld_remark",label:"Ubld Remark"},{key:"uleu_result",label:"Uleu Result"},{key:"uleu_remark",label:"Uleu Remark"},{key:"uery_result",label:"Uery Result"},{key:"uery_remark",label:"Uery Remark"},{key:"uecell_result",label:"UEcell Result"},{key:"uecell_remark",label:"UEcell Remark"},{key:"ucc_result",label:"UCC Result"},{key:"ucc_remark",label:"UCC Remark"},{key:"vdrl_result",label:"VDRL Result"},{key:"vdrl_remark",label:"VDRL Remark"},{key:"hbsag_result",label:"HBsAG Result"},{key:"hbsag_remark",label:"HBsAG Remark"},{key:"hbsab_result",label:"HBsAB Result"},{key:"hbsab_remark",label:"HBsAB Remark"},{key:"hcs_result",label:"Hep C Result"},{key:"hcs_remark",label:"Hep C Remark"}];return[{id:"personal",title:"Personal Info",kind:"kv",data:this.personalInfo,columns:e},{id:"occ",title:"Occupational History",kind:"table",data:this.occupationalRows,columns:a},{id:"fam",title:"Family History",kind:"table",data:this.familyRows,columns:l},{id:"fhd",title:"Family History Disease",kind:"kv",data:this.famDisease,columns:t},{id:"mh",title:"Medical History",kind:"kv",data:this.medicalHistory,columns:s},{id:"lifestyle",title:"Lifestyle",kind:"kv",data:this.lifestyle,columns:r},{id:"pe1",title:"Physical Exams",kind:"kv",data:this.pe1,columns:i},{id:"pe2",title:"Physical Exams 2",kind:"kv",data:this.pe2,columns:o},{id:"inv",title:"Investigations",kind:"kv",data:this.inv,columns:n},{id:"lab",title:"Investigations (Lab)",kind:"kv",data:this.lab,columns:k}]}},created(){const e=this.$route.query||{};this.sessionId=e.session_id||null,this.staffEmail=e.staff_email||null},async mounted(){await this.reload()},methods:{async reload(){this.busy=!0,this.loadError="";try{const e={session_id:this.sessionId,staff_email:this.staffEmail};this.personalInfo=await this.apiFetchPersonal(e),this.occupationalRows=await this.apiFetchOccHistory(e),this.familyRows=await this.apiFetchFamily(e),this.famDisease=await this.apiFetchFamDisease(e),this.medicalHistory=await this.apiFetchMedicalHistory(e),this.lifestyle=await this.apiFetchLifestyle(e),this.pe1=await this.apiFetchPE1(e),this.pe2=await this.apiFetchPE2(e),this.inv=await this.apiFetchInvestigations(e),this.lab=await this.apiFetchLab(e),this.$nextTick((()=>this.$refs.oneSheet&&this.$refs.oneSheet.open()))}catch(e){console.error(e),this.loadError=e?.message||"Unknown error"}finally{this.busy=!1}},async apiFetchPersonal({staff_email:e}){const a=e.replace(/\./g,"XYZ");return fetch(`${this.baseUrl}/staff/info/${encodeURIComponent(a)}`,{method:"GET",headers:{Authorization:`Bearer ${localStorage.getItem("jwt_token")}`,"Content-Type":"application/json"}}).then((e=>{if(!(0,z.$)(e))return e.json()})).then((e=>{this.personalInfo=e||{}})).catch((e=>{console.error("Error fetching staff info:",e),alert("Failed to fetch staff info.")})),this.personalInfo},async apiFetchOccHistory({staff_email:e}){const a=e.replace(/\./g,"XYZ");return fetch(`${this.baseUrl}/occupational-history/${a}`,{headers:{Authorization:`Bearer ${localStorage.getItem("jwt_token")}`}}).then((e=>e.json())).then((e=>{this.occupationalRows=e})).catch((e=>{console.error(e),this.occupationalRows=[]})),this.occupationalRows},async apiFetchFamily({staff_email:e}){const a=e.replace(/\./g,"XYZ");return fetch(`${this.baseUrl}/family-history/${a}`,{headers:{Authorization:`Bearer ${localStorage.getItem("jwt_token")}`}}).then((e=>e.json())).then((e=>{this.familyRows=e.family_history})).catch((e=>console.error(e))),this.familyRows},async apiFetchFamDisease({staff_email:e}){const a=e.replace(/\./g,"XYZ");return fetch(`${this.baseUrl}/family-history-disease/${a}`,{headers:{Authorization:`Bearer ${localStorage.getItem("jwt_token")}`}}).then((e=>e.json())).then((e=>{this.famDisease=Array.isArray(e)?e[0]||{}:e,Object.keys(this.famDisease).forEach((e=>{"staff_email"!==e&&"created_at"!==e&&"updated_at"!==e&&"details"!==e&&(this.famDisease[e]=!!this.famDisease[e])}))})).catch((e=>console.error(e))),this.famDisease},async apiFetchMedicalHistory({session_id:e}){return fetch(`${this.baseUrl}/medical-history/${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("jwt_token")}`}}).then((e=>e.json())).then((e=>{const a=Array.isArray(e)?e[0]||{}:e,l=(()=>{const e={};return this.medicalFields.forEach((a=>{e[a.key]=!1})),e.comment_by_examine_doctor="",e})();this.medicalFields.forEach((e=>{const t=a[e.key];"Y"===t?l[e.key]=!0:"N"===t?l[e.key]=!1:"boolean"===typeof t&&(l[e.key]=t)})),l.comment_by_examine_doctor=a.comment_by_examine_doctor||"",this.medicalHistory=l})).catch((e=>console.error(e))),this.medicalHistory},async apiFetchLifestyle({session_id:e}){return fetch(`${this.baseUrl}/lifestyle/${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("jwt_token")}`}}).then((e=>e.json())).then((e=>{this.lifestyle=Array.isArray(e)?e[0]||{}:e})).catch((e=>console.error(e))),this.lifestyle},async apiFetchPE1({session_id:e}){return fetch(`${this.baseUrl}/physical-exams/${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("jwt_token")}`}}).then((e=>e.json())).then((e=>{this.pe1=Array.isArray(e)?e[0]||{}:e})).catch((e=>console.error(e))),this.pe1},async apiFetchPE2({session_id:e}){return fetch(`${this.baseUrl}/physical-exams-2/${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("jwt_token")}`}}).then((e=>e.json())).then((e=>{this.pe2=Array.isArray(e)?e[0]||{}:e})).catch((e=>console.error(e))),this.pe2},async apiFetchLab({session_id:e}){return fetch(`${this.baseUrl}/investigations-lab/${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("jwt_token")}`}}).then((e=>e.json())).then((e=>{this.lab=Array.isArray(e)?e[0]||{}:e})).catch((e=>console.error(e))),this.lab},async apiFetchInvestigations({session_id:e}){return fetch(`${this.baseUrl}/investigations/${e}`,{headers:{Authorization:`Bearer ${localStorage.getItem("jwt_token")}`}}).then((e=>e.json())).then((e=>{this.inv=Array.isArray(e)?e[0]||{}:e})).catch((e=>console.error(e))),this.inv}}};const M=(0,F.A)(j,[["render",c],["__scopeId","data-v-75502248"]]);var G=M}}]);
//# sourceMappingURL=140.030f0b7f.js.map