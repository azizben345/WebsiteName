{"version":3,"file":"js/140.030f0b7f.js","mappings":"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","sources":["webpack://bmi-app-gen/./src/views/ExportMedicalRecord.vue","webpack://bmi-app-gen/./src/components/OneSheetExport.vue","webpack://bmi-app-gen/./src/components/OneSheetExport.vue?e918","webpack://bmi-app-gen/./src/views/ExportMedicalRecord.vue?1d95"],"sourcesContent":["<template>\r\n  <div class=\"export-page\">\r\n    <header class=\"top\">\r\n      <h2>Export Medical Record</h2>\r\n      <div style=\"height: 1rem;\"></div>\r\n    </header>\r\n\r\n    <section class=\"status\" v-if=\"busy\">\r\n      Preparing data… please wait.\r\n    </section>\r\n    <section class=\"status error\" v-else-if=\"loadError\">\r\n      Failed to load: {{ loadError }}\r\n    </section>\r\n\r\n    <section v-else class=\"ready\">\r\n      <!-- You can show a summary or counts here if you like -->\r\n      <p>Data is ready. Click \"Export\" button below to download.</p>\r\n    </section>\r\n\r\n    <div class=\"meta\">\r\n      <div>Session: <strong>{{ sessionId || '—' }}</strong></div>\r\n      <div>Staff: <strong>{{ staffEmail || '—' }}</strong></div>\r\n    </div>\r\n    <div class=\"actions\">\r\n      <button :disabled=\"busy\" @click=\"reload\">{{ busy ? 'Loading…' : 'Reload' }}</button>\r\n      <button @click=\"$router.back()\">Back</button>\r\n    </div>\r\n\r\n    <!-- Exporter: will open automatically after fetch -->\r\n    <OneSheetExport\r\n      ref=\"oneSheet\"\r\n      :sections=\"sections\"\r\n      :filename=\"`medical-record-${staffEmail}.xlsx`\"\r\n      title=\"Export medical record (one sheet)\"\r\n    />\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport OneSheetExport from '@/components/OneSheetExport.vue';\r\nimport cfg from '@/apiConfig';\r\nimport { handleUnauthorized } from '@/shared/handleUnauthorized';\r\n\r\n// tiny formatters\r\nconst yesNo  = v => (v === true ? 'Yes' : v === false ? 'No' : (v ?? ''));\r\nconst fmtDate = v => (v ?? '');\r\n\r\nexport default {\r\n  name: 'ExportMedicalRecord',\r\n  components: { OneSheetExport },\r\n\r\n  data() {\r\n    return {\r\n      baseUrl: cfg.API_BASE_URL,\r\n      busy: false,\r\n      loadError: '',\r\n      // query\r\n      sessionId: null,\r\n      staffEmail: null,\r\n      // datasets\r\n      personalInfo: null,\r\n      occupationalRows: [],\r\n      familyRows: [],\r\n      famDisease: null,\r\n      medicalHistory: null,\r\n      medicalFields: [\r\n        { key: 'abnormal_heartbeat', label: 'Abnormal Heartbeat' },\r\n        { key: 'bladder_trouble', label: 'Bladder Trouble' },\r\n        { key: 'dermatitis_eczema', label: 'Dermatitis / Eczema' },\r\n        { key: 'depression', label: 'Depression' },\r\n        { key: 'heart_murmur', label: 'Heart Murmur' },\r\n        { key: 'hernia', label: 'Hernia' },\r\n        { key: 'jaundice', label: 'Jaundice' },\r\n        { key: 'kidney_disease', label: 'Kidney Disease' },\r\n        { key: 'peptic_ulcer', label: 'Peptic Ulcer' },\r\n        { key: 'persistent_night_sweats', label: 'Persistent Night Sweats' },\r\n        { key: 'rectal_bleeding', label: 'Rectal Bleeding' },\r\n        { key: 'unintentional_weight_loss', label: 'Unintentional Weight Loss' },\r\n        { key: 'asthma_bronchitis', label: 'Asthma / Bronchitis' },\r\n        { key: 'bowel_disorder', label: 'Bowel Disorder' },\r\n        { key: 'diabetes', label: 'Diabetes' },\r\n        { key: 'frequent_indigestion', label: 'Frequent Indigestion' },\r\n        { key: 'high_blood_pressure', label: 'High Blood Pressure' },\r\n        { key: 'hospitalisation_surgery', label: 'Hospitalisation / Surgery' },\r\n        { key: 'migraine_headache', label: 'Migraine / Headache' },\r\n        { key: 'psoriasis_skin_disease', label: 'Psoriasis / Skin Disease' },\r\n        { key: 'persistent_diarrhoea', label: 'Persistent Diarrhoea' },\r\n        { key: 'renal_colic_stone', label: 'Renal Colic / Stone' },\r\n        { key: 'swollen_lymph_glands', label: 'Swollen Lymph Glands' },\r\n        { key: 'anxiety', label: 'Anxiety' },\r\n        { key: 'blood_in_urine', label: 'Blood in Urine' },\r\n        { key: 'dizziness_giddiness', label: 'Dizziness / Giddiness' },\r\n        { key: 'faints_blackouts', label: 'Faints / Blackouts' },\r\n        { key: 'hay_fever', label: 'Hay Fever' },\r\n        { key: 'joint_disorder', label: 'Joint Disorder' },\r\n        { key: 'liver_gall_bladder', label: 'Liver / Gall / Bladder' },\r\n        { key: 'piles_haemorrhoids', label: 'Piles / Haemorrhoids' },\r\n        { key: 'rheumatic_fever', label: 'Rheumatic Fever' },\r\n        { key: 'std', label: 'STD' },\r\n        { key: 'tuberculosis', label: 'Tuberculosis' },\r\n        { key: 'none_of_the_above', label: 'None of the Above' },\r\n      ],\r\n      lifestyle: null,\r\n      pe1: null,\r\n      pe2: null,\r\n      inv: null,\r\n      lab: null,\r\n    };\r\n  },\r\n\r\n  computed: {\r\n    sections() {\r\n      // Define columns (same as we used in Dashboard option B)\r\n      const personalInfoCols = [\r\n        { key:'staff_name',  label:'Name' },\r\n        { key:'staff_email', label:'Email' },\r\n        { key:'staff_no',    label:'Staff No' },\r\n        { key:'job_title',   label:'Job Title / Position' },\r\n        { key:'department', label: 'Department' },\r\n        { key:'marital_status', label:'Marital Status' },\r\n        { key:'sex', label:'Sex' },\r\n        { key:'date_of_birth', label:'Date of Birth', format: fmtDate },\r\n        { key:'ic_passport', label:'IC/Passport' },\r\n        { key:'nationality', label:'Nationality' },\r\n        { key:'phone_no', label:'Phone' },\r\n        { key:'address', label:'Address' },\r\n        { key:'personal_doctor_email', label:'Personal Doctor Email' },\r\n        { key:'doctor_phone_no', label:'Doctor Phone' },\r\n        { key:'reason_for_examination', label:'Reason' },\r\n        { key:'date_of_this_assessment', label:'Date of This Assessment', format: fmtDate },\r\n        { key:'date_of_last_assessment', label:'Date of Last Assessment', format: fmtDate },\r\n        { key:'created_at',  label:'Created At', format: fmtDate },\r\n        { key:'updated_at',  label:'Updated At', format: fmtDate },\r\n      ];\r\n\r\n      const occupationalCols = [\r\n        { key:'year',           label:'Year' },\r\n        { key:'company',       label:'Company' },\r\n        { key:'location',          label:'Location' },\r\n        { key:'job_title',      label:'Job Title' },\r\n        { key:'nature_of_work', label:'Nature of Work' },\r\n      ];\r\n\r\n      const familyCols = [\r\n        { key:'relationship',               label:'Relationship' },\r\n        { key:'relative_name',              label:'Name' },\r\n        { key:'sex',                        label:'Sex' },\r\n        { key:'year_of_born',               label:'Year of Birth' },\r\n        { key:'age_now',                    label:'Age Now' },\r\n        { key:'age_at_death',               label:'Age at Death' },\r\n        { key:'state_health_death_cause',   label:'State of Health / Cause of Death' },\r\n        { key:'updated_at',                 label:'Updated At', format: fmtDate },\r\n      ];\r\n\r\n      const famDiseaseCols = [\r\n        { key:'heart_disease',      label:'Heart Disease', format: yesNo },\r\n        { key:'high_blood_pressure',label:'High Blood Pressure', format: yesNo },\r\n        { key:'stroke',             label:'Stroke', format: yesNo },\r\n        { key:'cancer',             label:'Cancer', format: yesNo },\r\n        { key:'diabetes',           label:'Diabetes', format: yesNo },\r\n        { key:'kidney_disease',     label:'Kidney Disease', format: yesNo },\r\n        { key:'allergy',            label:'Allergy', format: yesNo },\r\n        { key:'asthma',             label:'Asthma', format: yesNo },\r\n        { key:'eczema',             label:'Eczema', format: yesNo },\r\n        { key:'tuberculosis',       label:'Tuberculosis', format: yesNo },\r\n        { key:'epilepsy',           label:'Epilepsy', format: yesNo },\r\n        { key:'mental_disorder',    label:'Mental Disorder', format: yesNo },\r\n        { key:'alcohol_dependence', label:'Alcohol Dependence', format: yesNo },\r\n        { key:'drug_abuse',         label:'Drug Abuse', format: yesNo },\r\n        { key:'birth_abnormality',  label:'Birth Abnormality', format: yesNo },\r\n        { key:'details',            label:'Details' },\r\n        { key:'created_at',         label:'Created At', format: fmtDate },\r\n        { key:'updated_at',         label:'Updated At', format: fmtDate },\r\n      ];\r\n\r\n      const medicalCols = [\r\n        { key:'abnormal_heartbeat', label:'Abnormal heartbeat', format: yesNo },\r\n        { key:'abnormal_heartbeat', label:'Abnormal heartbeat', format: yesNo },\r\n        { key:'bladder_trouble', label:'Bladder trouble', format: yesNo },\r\n        { key:'dermatitis_eczema', label:'Dermatitis/Eczema', format: yesNo },\r\n        { key:'depression', label:'Depression', format: yesNo },\r\n        { key:'heart_murmur', label:'Heart Murmur', format: yesNo },\r\n        { key:'hernia', label:'Hernia', format: yesNo },\r\n        { key:'jaundice', label:'Jaundice', format: yesNo },\r\n        { key:'kidney_disease', label:'Kidney Disease', format: yesNo },\r\n        { key:'peptic_ulcer', label:'Peptic Ulcer', format: yesNo },\r\n        { key:'persistent_night_sweats', label:'Persistent Night Sweats', format: yesNo },\r\n        { key:'rectal_bleeding', label:'Rectal Bleeding', format: yesNo },\r\n        { key:'unintentional_weight_loss', label:'Unintentional Weight Loss', format: yesNo },\r\n        { key:'asthma_bronchitis', label:'Asthma/Bronchitis', format: yesNo },\r\n        { key:'bowel_disorder', label:'Bowel Disorder', format: yesNo },\r\n        { key:'diabetes', label:'Diabetes', format: yesNo },\r\n        { key:'frequent_indigestion', label:'Frequent Indigestion', format: yesNo },\r\n        { key:'high_blood_pressure', label:'High Blood Pressure', format: yesNo },\r\n        { key:'hospitalisation_surgery', label:'Hospitalisation/Surgery', format: yesNo },\r\n        { key:'migraine_headache', label:'Migraine Headache', format: yesNo },\r\n        { key:'psoriasis_skin_disease', label:'Psoriasis Skin Disease', format: yesNo },\r\n        { key:'persistent_diarrhoea', label:'Persistent Diarrhoea', format: yesNo },\r\n        { key:'renal_colic_stone', label:'Renal Colic Stone', format: yesNo },\r\n        { key:'swollen_lymph_glands', label:'Swollen Lymph Glands', format: yesNo },\r\n        { key:'anxiety', label:'Anxiety', format: yesNo },\r\n        { key:'blood_in_urine', label:'Blood in Urine', format: yesNo },\r\n        { key:'dizziness_giddiness', label:'Dizziness/Giddiness', format: yesNo },\r\n        { key:'faints_blackouts', label:'Faints/Blackouts', format: yesNo },\r\n        { key:'hay_fever', label:'Hay Fever', format: yesNo },\r\n        { key:'joint_disorder', label:'Joint Disorder', format: yesNo },\r\n        { key:'liver_gall_bladder', label:'Liver Gall Bladder', format: yesNo },\r\n        { key:'piles_haemorrhoids', label:'Piles/Haemorrhoids', format: yesNo },\r\n        { key:'rheumatic_fever', label:'Rheumatic Fever', format: yesNo },\r\n        { key:'std', label:'STD', format: yesNo },\r\n        { key:'tuberculosis', label:'Tuberculosis', format: yesNo },\r\n        { key:'none_of_the_above', label:'None of the above', format: yesNo },\r\n        { key:'comment_by_examine_doctor', label:'Doctor Comment' },\r\n        { key:'created_at', label:'Created At', format: fmtDate },\r\n      ];\r\n\r\n      const lifestyleCols = [\r\n        { key:'smoking_habit',       label:'Smoking Habit' },\r\n        { key:'years_smoked',        label:'Years Smoked' },\r\n        { key:'amount_smoke_day',    label:'Amount/Day' },\r\n        { key:'date_stopped',        label:'Date Stopped', format: fmtDate },\r\n        { key:'alcohol_drink',       label:'Alcohol Drink' },\r\n        { key:'drink_per_week',      label:'Drinks/Week' },\r\n        { key:'taking_prescribed_drugs', label:'Taking Prescribed Drugs' },\r\n        { key:'drug_detail',         label:'Drug Detail' },\r\n        { key:'declaration_consent', label:'Consent', format: yesNo },\r\n        { key:'consent_signer_name', label:'Consent Signer' },\r\n        { key:'consent_signer_date', label:'Consent Date', format: fmtDate },\r\n        { key:'created_at',          label:'Created At', format: fmtDate },\r\n        { key:'updated_at',          label:'Updated At', format: fmtDate },\r\n      ];\r\n\r\n      const pe1Cols = [\r\n        { key:'pe_id',           label:'PE ID' },\r\n        { key:'staff_email',    label:'Staff Email' },\r\n        { key:'session_id',     label:'Session ID' },\r\n        { key:'weight_kg',      label:'Weight (kg)' },\r\n        { key:'height_m',       label:'Height (m)' },\r\n        { key:'bmi',             label:'BMI' },\r\n        { key:'bp_sys',          label:'BP Systolic' },\r\n        { key:'bp_dia',          label:'BP Diastolic' },\r\n        { key:'pulse_bpm',       label:'Pulse (bpm)' },\r\n        { key:'blood_group',     label:'Blood Group' },\r\n        { key:'dist_uncorr_r',    label:'Distance Uncorrected Right Eye' },\r\n        { key:'dist_uncorr_l',   label:'Distance Uncorrected Left Eye' },\r\n        { key:'dist_uncorr_b',    label:'Distance Uncorrected Both Eyes' },\r\n        { key:'dist_corr_r',      label:'Distance Corrected Right Eye' },\r\n        { key:'dist_corr_l',      label:'Distance Corrected Left Eye' },\r\n        { key:'dist_corr_b',      label:'Distance Corrected Both Eyes' },\r\n        { key:'near_uncorr_r',    label:'Near Uncorrected Right Eye' },\r\n        { key:'near_uncorr_l',   label:'Near Uncorrected Left Eye' },\r\n        { key:'near_uncorr_b',    label:'Near Uncorrected Both Eyes' },\r\n        { key:'near_corr_r',      label:'Near Corrected Right Eye' },\r\n        { key:'near_corr_l',      label:'Near Corrected Left Eye' },\r\n        { key:'near_corr_b',      label:'Near Corrected Both Eyes' },\r\n        { key:'colour_vision',    label:'Colour Vision' },\r\n        { key:'created_at',     label:'Created At', format: fmtDate },\r\n        { key:'updated_at',     label:'Updated At', format: fmtDate },\r\n      ];\r\n\r\n      const pe2Cols = [\r\n        { key:'pe2_id',            label:'PE2 ID' },\r\n        { key:'staff_email',        label:'Staff Email' },\r\n        { key:'session_id',        label:'Session ID' },\r\n        { key:'head',            label:'Head' },\r\n        { key:'head_details_abnormality', label:'Head Details' },\r\n        { key:'eyes',            label:'Eyes' },\r\n        { key:'eyes_details_abnormality', label:'Eyes Details' },\r\n        { key:'ears_and_drums', label:'Ears and Drums' },\r\n        { key:'ears_and_drums_details_abnormality', label:'Ears and Drums Details' },\r\n        { key:'hearing',            label:'Hearing' },\r\n        { key:'hearing_details_abnormality', label:'Hearing Details' },\r\n        { key:'nose_and_sinuses', label:'Nose and Sinuses' },\r\n        { key:'nose_and_sinuses_details_abnormality', label:'Nose and Sinuses Details' },\r\n        { key:'mouth_teeth_throat', label:'Mouth, Teeth, Throat' },\r\n        { key:'mouth_teeth_throat_details_abnormality', label:'Mouth, Teeth, Throat Details' },\r\n        { key:'neck_and_thyroid', label:'Neck and Thyroid' },\r\n        { key:'neck_and_thyroid_details_abnormality', label:'Neck and Thyroid Details' },\r\n        { key:'chest_and_lungs', label:'Chest and Lungs' },\r\n        { key:'chest_and_lungs_details_abnormality', label:'Chest and Lungs Details' },\r\n        { key:'breasts',            label:'Breasts' },\r\n        { key:'breasts_details_abnormality', label:'Breasts Details' },\r\n        { key:'heart',            label:'Heart' },\r\n        { key:'heart_details_abnormality', label:'Heart Details' },\r\n        { key:'peripheral_arteries', label:'Peripheral Arteries' },\r\n        { key:'peripheral_arteries_details_abnormality', label:'Peripheral Arteries Details' },\r\n        { key:'peripheral_veins', label:'Peripheral Veins' },\r\n        { key:'peripheral_veins_details_abnormality', label:'Peripheral Veins Details' },\r\n        { key:'abdomen',            label:'Abdomen' },\r\n        { key:'abdomen_details_abnormality', label:'Abdomen Details' },\r\n        { key:'hernia_orifices', label:'Hernia Orifices' },\r\n        { key:'hernia_orifices_details_abnormality', label:'Hernia Orifices Details' },\r\n        { key:'genitalia',        label:'Genitalia' },\r\n        { key:'genitalia_details_abnormality', label:'Genitalia Details' },\r\n        { key:'rectal_examination', label:'Rectal Examination' },\r\n        { key:'rectal_examination_details_abnormality', label:'Rectal Examination Details' },\r\n        { key:'upper_limbs',        label:'Upper Limbs' },\r\n        { key:'upper_limbs_details_abnormality', label:'Upper Limbs Details' },\r\n        { key:'lower_limbs',        label:'Lower Limbs' },\r\n        { key:'lower_limbs_details_abnormality', label:'Lower Limbs Details' },\r\n        { key:'spine',            label:'Spine' },\r\n        { key:'spine_details_abnormality', label:'Spine Details' },\r\n        { key:'skin',            label:'Skin' },\r\n        { key:'skin_details_abnormality', label:'Skin Details' },\r\n        { key:'lymph_nodes',        label:'Lymph Nodes' },\r\n        { key:'lymph_nodes_details_abnormality', label:'Lymph Nodes Details' },\r\n        { key:'neurological',        label:'Neurological' },\r\n        { key:'neurological_details_abnormality', label:'Neurological Details' },\r\n        { key:'psychiatric',        label:'Psychiatric' },\r\n        { key:'psychiatric_details_abnormality', label:'Psychiatric Details' },\r\n        { key:'created_at',        label:'Created At', format: fmtDate },\r\n        { key:'updated_at',        label:'Updated At', format: fmtDate },\r\n      ];\r\n\r\n      const invCols = [\r\n        { key:'inv_id',            label:'Inv ID' },\r\n        { key:'staff_email',      label:'Staff Email' },\r\n        { key:'session_id',     label:'Session ID' },\r\n        { key:'spirometry_status', label:'Spirometry Status' },\r\n        { key:'spirometry_details',label:'Spirometry Details' },\r\n        { key:'audiometry_status',  label:'Audiometry Status' },\r\n        { key:'audiometry_details', label:'Audiometry Details' },\r\n        { key:'chest_xray_status', label:'Chest Xray Status' },\r\n        { key:'chest_xray_details', label:'Chest Xray Details' },\r\n        { key:'electrocardiograph_status', label:'Electrocardiograph Status' },\r\n        { key:'electrocardiograph_details', label:'Electrocardiograph Details' },\r\n        // urine drug tests:\r\n        { key:'opiates_result',       label:'Opiates Result' },\r\n        { key:'opiates_remark',     label:'Opiates Remark' },\r\n        { key:'cannabinoids_result', label:'Cannabinoids Result' },\r\n        { key:'cannabinoids_remark',   label:'Cannabinoids Remark' },\r\n        { key:'amphetamine_result', label:'Amphetamine Result' },\r\n        { key:'amphetamine_remark', label:'Amphetamine Remark' },\r\n        { key:'mdma_result',         label:'MDMA Result' },\r\n        { key:'mdma_remark',       label:'MDMA Remark' },\r\n        { key:'benzodiazepine_result', label:'Benzodiazepine Result' },\r\n        { key:'benzodiazepine_remark', label:'Benzodiazepine Remark' },\r\n        { key:'remarks_ohd',       label:'Remarks by Examine Doctor' },\r\n        { key:'created_at',        label:'Created At', format: fmtDate },\r\n        { key:'updated_at',        label:'Updated At', format: fmtDate },\r\n      ];\r\n\r\n      const labCols = [\r\n        { key:'ilab_id',       label:'ILAB ID' },\r\n        { key:'staff_email',     label:'Staff Email' },\r\n        { key:'session_id',     label:'Session ID' },\r\n        { key:'hb_result',      label:'Hb Result' },\r\n        { key:'hb_remark',      label:'Hb Remark' },\r\n        { key:'rbc_result',      label:'RBC Result' },\r\n        { key:'rbc_remark',      label:'RBC Remark' },\r\n        { key:'pcv_result',      label:'PCV Result' },\r\n        { key:'pcv_remark',      label:'PCV Remark' },\r\n        { key:'mcv_result',      label:'MCV Result' },\r\n        { key:'mcv_remark',      label:'MCV Remark' },\r\n        { key:'mch_result',      label:'MCH Result' },\r\n        { key:'mch_remark',      label:'MCH Remark' },\r\n        { key:'mchc_result',     label:'MCHC Result' },\r\n        { key:'mchc_remark',     label:'MCHC Remark' },\r\n        { key:'rdw_result',      label:'RDW Result' },\r\n        { key:'rdw_remark',      label:'RDW Remark' },\r\n        { key:'wbc_result',      label:'WBC Result' },\r\n        { key:'wbc_remark',      label:'WBC Remark' },\r\n        { key:'neut_result',     label:'Neut Result' },\r\n        { key:'neut_remark',     label:'Neut Remark' },\r\n        { key:'lym_result',      label:'Lym Result' },\r\n        { key:'lym_remark',      label:'Lym Remark' },\r\n        { key:'mon_result',      label:'Mon Result' },\r\n        { key:'mon_remark',      label:'Mon Remark' },\r\n        { key:'eon_result',      label:'Eon Result' },\r\n        { key:'eon_remark',      label:'Eon Remark' },\r\n        { key:'bas_result',      label:'Bas Result' },\r\n        { key:'bas_remark',      label:'Bas Remark' },\r\n        { key:'plet_result',     label:'Plet Result' },\r\n        { key:'plet_remark',     label:'Plet Remark' },\r\n        { key:'esr_result',      label:'ESR Result' },\r\n        { key:'esr_remark',      label:'ESR Remark' },\r\n        { key:'fbp_result',      label:'FBP Result' },\r\n        { key:'fbp_remark',      label:'FBP Remark' },\r\n        { key:'fbs_result',      label:'FBS Result' },\r\n        { key:'fbs_remark',      label:'FBS Remark' },\r\n        { key:'rbs_result',      label:'RBS Result' },\r\n        { key:'rbs_remark',      label:'RBS Remark' },\r\n        { key:'tchol_result',     label:'Tchol Result' },\r\n        { key:'tchol_remark',     label:'Tchol Remark' },\r\n        { key:'tg_result',      label:'TG Result' },\r\n        { key:'tg_remark',      label:'TG Remark' },\r\n        { key:'hdl_result',      label:'HDL Result' },\r\n        { key:'hdl_remark',      label:'HDL Remark' },\r\n        { key:'ldl_result',      label:'LDL Result' },\r\n        { key:'ldl_remark',      label:'LDL Remark' },\r\n        { key:'na_result',      label:'Na Result' },\r\n        { key:'na_remark',      label:'Na Remark' },\r\n        { key:'k_result',       label:'K Result' },\r\n        { key:'k_remark',       label:'K Remark' },\r\n        { key:'cl_result',      label:'Cl Result' },\r\n        { key:'cl_remark',      label:'Cl Remark' },\r\n        { key:'bu_result',      label:'BU Result' },\r\n        { key:'bu_remark',      label:'BU Remark' },\r\n        { key:'creat_result',     label:'Creat Result' },\r\n        { key:'creat_remark',     label:'Creat Remark' },\r\n        { key:'ua_result',      label:'UA Result' },\r\n        { key:'ua_remark',      label:'UA Remark' },\r\n        { key:'ca_result',      label:'Ca Result' },\r\n        { key:'ca_remark',      label:'Ca Remark' },\r\n        { key:'cca_result',     label:'Cca Result' },\r\n        { key:'cca_remark',     label:'Cca Remark' },\r\n        { key:'po4_result',      label:'PO4 Result' },\r\n        { key:'po4_remark',      label:'PO4 Remark' },\r\n        { key:'tprot_result',     label:'Tprot Result' },\r\n        { key:'tprot_remark',     label:'Tprot Remark' },\r\n        { key:'alb_result',      label:'Alb Result' },\r\n        { key:'alb_remark',      label:'Alb Remark' },\r\n        { key:'glo_result',      label:'Glo Result' },\r\n        { key:'glo_remark',      label:'Glo Remark' },\r\n        { key:'agr_result',      label:'AGR Result' },\r\n        { key:'agr_remark',      label:'AGR Remark' },\r\n        { key:'alkp_result',     label:'AlkP Result' },\r\n        { key:'alkp_remark',     label:'AlkP Remark' },\r\n        { key:'tbil_result',     label:'Tbil Result' },\r\n        { key:'tbil_remark',     label:'Tbil Remark' },\r\n        { key:'ggt_result',      label:'GGT Result' },\r\n        { key:'ggt_remark',      label:'GGT Remark' },\r\n        { key:'ast_result',      label:'AST Result' },\r\n        { key:'ast_remark',      label:'AST Remark' },\r\n        { key:'alt_result',      label:'ALT Result' },\r\n        { key:'alt_remark',      label:'ALT Remark' },\r\n        { key:'uprot_result',     label:'Uprot Result' },\r\n        { key:'uprot_remark',     label:'Uprot Remark' },\r\n        { key:'uph_result',      label:'UpH Result' },\r\n        { key:'uph_remark',      label:'UpH Remark' },\r\n        { key:'uglu_result',     label:'Uglu Result' },\r\n        { key:'uglu_remark',     label:'Uglu Remark' },\r\n        { key:'uket_result',     label:'Uket Result' },\r\n        { key:'uket_remark',     label:'Uket Remark' },\r\n        { key:'usg_result',      label:'USG Result' },\r\n        { key:'usg_remark',      label:'USG Remark' },\r\n        { key:'ubld_result',     label:'Ubld Result' },\r\n        { key:'ubld_remark',     label:'Ubld Remark' },\r\n        { key:'uleu_result',     label:'Uleu Result' },\r\n        { key:'uleu_remark',     label:'Uleu Remark' },\r\n        { key:'uery_result',     label:'Uery Result' },\r\n        { key:'uery_remark',     label:'Uery Remark' },\r\n        { key:'uecell_result',     label:'UEcell Result' },\r\n        { key:'uecell_remark',     label:'UEcell Remark' },\r\n        { key:'ucc_result',      label:'UCC Result' },\r\n        { key:'ucc_remark',      label:'UCC Remark' },\r\n        { key:'vdrl_result',     label:'VDRL Result' },\r\n        { key:'vdrl_remark',     label:'VDRL Remark' },\r\n        { key:'hbsag_result',     label:'HBsAG Result' },\r\n        { key:'hbsag_remark',     label:'HBsAG Remark' },\r\n        { key:'hbsab_result',     label:'HBsAB Result' },\r\n        { key:'hbsab_remark',     label:'HBsAB Remark' },\r\n        { key:'hcs_result',      label:'Hep C Result' },\r\n        { key:'hcs_remark',      label:'Hep C Remark' },\r\n      ];\r\n\r\n      return [\r\n        { id:'personal', title:'Personal Info',         kind:'kv',    data: this.personalInfo,     columns: personalInfoCols },\r\n        { id:'occ',      title:'Occupational History',  kind:'table', data: this.occupationalRows, columns: occupationalCols },\r\n        { id:'fam',      title:'Family History',        kind:'table', data: this.familyRows,       columns: familyCols },\r\n        { id:'fhd',      title:'Family History Disease',kind:'kv',    data: this.famDisease,       columns: famDiseaseCols },\r\n        { id:'mh',       title:'Medical History',       kind:'kv',    data: this.medicalHistory,   columns: medicalCols },\r\n        { id:'lifestyle',title:'Lifestyle',             kind:'kv',    data: this.lifestyle,        columns: lifestyleCols },\r\n        { id:'pe1',      title:'Physical Exams',        kind:'kv',    data: this.pe1,              columns: pe1Cols },\r\n        { id:'pe2',      title:'Physical Exams 2',      kind:'kv',    data: this.pe2,              columns: pe2Cols },\r\n        { id:'inv',      title:'Investigations',        kind:'kv',    data: this.inv,              columns: invCols },\r\n        { id:'lab',      title:'Investigations (Lab)',    kind:'kv',    data: this.lab,              columns: labCols },\r\n      ];\r\n    },\r\n  },\r\n\r\n  created() {\r\n    // read query params\r\n    const q = this.$route.query || {};\r\n    this.sessionId = q.session_id || null;\r\n    this.staffEmail = q.staff_email || null;\r\n  },\r\n\r\n  async mounted() {\r\n    await this.reload();\r\n  },\r\n\r\n  methods: {\r\n    async reload() {\r\n      this.busy = true;\r\n      this.loadError = '';\r\n\r\n      try {\r\n        // Fetch all datasets for this (session_id, staff_email)\r\n        const params = { session_id: this.sessionId, staff_email: this.staffEmail };\r\n\r\n        this.personalInfo = await this.apiFetchPersonal(params);\r\n        this.occupationalRows = await this.apiFetchOccHistory(params);\r\n        this.familyRows = await this.apiFetchFamily(params);\r\n        this.famDisease = await this.apiFetchFamDisease(params);\r\n        this.medicalHistory = await this.apiFetchMedicalHistory(params);\r\n        this.lifestyle = await this.apiFetchLifestyle(params);\r\n        this.pe1 = await this.apiFetchPE1(params);\r\n        this.pe2 = await this.apiFetchPE2(params);\r\n        this.inv = await this.apiFetchInvestigations(params);\r\n        this.lab = await this.apiFetchLab(params);\r\n\r\n        // Open the export dialog automatically after data is ready\r\n        this.$nextTick(() => this.$refs.oneSheet && this.$refs.oneSheet.open());\r\n      } catch (e) {\r\n        console.error(e);\r\n        this.loadError = e?.message || 'Unknown error';\r\n      } finally {\r\n        this.busy = false;\r\n      }\r\n    },\r\n\r\n    // ====== API calls ======\r\n    async apiFetchPersonal({ staff_email }) {\r\n        // let staffData = {};\r\n        const staffEmailXYZ = staff_email.replace(/\\./g, 'XYZ');\r\n        // const baseUrl = cfg.API_BASE_URL;\r\n\r\n        fetch(`${this.baseUrl}/staff/info/${encodeURIComponent(staffEmailXYZ)}`, {\r\n            method: 'GET',\r\n            headers: {\r\n            Authorization: `Bearer ${localStorage.getItem('jwt_token')}`,\r\n            'Content-Type': 'application/json'\r\n            }\r\n        })\r\n        .then(res => {\r\n          if (handleUnauthorized(res)) return;\r\n\r\n          return res.json();\r\n        })\r\n        .then(data => {\r\n            this.personalInfo = data || {};\r\n        })\r\n        .catch(err => {\r\n            console.error('Error fetching staff info:', err);\r\n            alert('Failed to fetch staff info.');\r\n        });\r\n        return this.personalInfo;\r\n    },\r\n    async apiFetchOccHistory({ staff_email }) { \r\n      // let occupationalHistory = [];\r\n      const staffEmailXYZ = staff_email.replace(/\\./g, 'XYZ');\r\n      // const baseUrl = cfg.API_BASE_URL;\r\n\r\n      fetch(`${this.baseUrl}/occupational-history/${staffEmailXYZ}`, {\r\n        headers: { Authorization: `Bearer ${localStorage.getItem('jwt_token')}` }\r\n      })\r\n        .then(res => res.json())\r\n        .then(data => {\r\n          this.occupationalRows = data;\r\n        })\r\n        .catch(err => {\r\n          console.error(err);\r\n          this.occupationalRows = [];\r\n        });\r\n        return this.occupationalRows;\r\n    },\r\n    async apiFetchFamily({ staff_email }) {\r\n        // let familyHistory = [];\r\n        const staffEmailXYZ = staff_email.replace(/\\./g, 'XYZ');\r\n        // const baseUrl = cfg.API_BASE_URL;\r\n\r\n      fetch(`${this.baseUrl}/family-history/${staffEmailXYZ}`, {\r\n        headers: { \r\n          Authorization: `Bearer ${localStorage.getItem('jwt_token')}` \r\n        }\r\n      })\r\n        .then(res => res.json())\r\n        .then(data => {\r\n          this.familyRows = data.family_history;\r\n        })\r\n        .catch(err => console.error(err));\r\n        return this.familyRows;\r\n    },\r\n    async apiFetchFamDisease({ staff_email }) { \r\n        // let familyHistoryDisease = [];\r\n        const staffEmailXYZ = staff_email.replace(/\\./g, 'XYZ');\r\n        // const baseUrl = cfg.API_BASE_URL;\r\n        \r\n        fetch(`${this.baseUrl}/family-history-disease/${staffEmailXYZ}`, {\r\n        headers: { \r\n          Authorization: `Bearer ${localStorage.getItem('jwt_token')}` \r\n        }\r\n      })\r\n        .then(res => res.json())\r\n        .then(data => {\r\n\r\n          // if data is an array, take the first element\r\n          this.famDisease = Array.isArray(data) ? data[0] || {} : data;\r\n\r\n          // convert numbers to booleans\r\n          Object.keys(this.famDisease).forEach(key => {\r\n            if (key !== 'staff_email' && key !== 'created_at' && key !== 'updated_at' && key !== 'details') {\r\n              this.famDisease[key] = !!this.famDisease[key]; // 0 -> false, 1 -> true\r\n            }\r\n          });\r\n        })\r\n        .catch(err => console.error(err));\r\n        return this.famDisease;\r\n    },\r\n    async apiFetchMedicalHistory({ session_id }) {\r\n        // let medicalHistory = {};\r\n        // const baseUrl = cfg.API_BASE_URL;\r\n\r\n        fetch(`${this.baseUrl}/medical-history/${session_id}`, {\r\n            headers: { Authorization: `Bearer ${localStorage.getItem('jwt_token')}` }\r\n        })\r\n        .then(res => res.json())\r\n        .then(raw => {\r\n          const data = Array.isArray(raw) ? (raw[0] || {}) : raw\r\n\r\n          // start from defaults so every key exists\r\n          const normalized = (() => {\r\n            const base = {}\r\n            this.medicalFields.forEach(f => { base[f.key] = false })\r\n            base.comment_by_examine_doctor = ''\r\n            return base\r\n          })()\r\n\r\n          // convert Y/N to boolean where present\r\n          this.medicalFields.forEach(f => {\r\n            const v = data[f.key]\r\n            if (v === 'Y') normalized[f.key] = true\r\n            else if (v === 'N') normalized[f.key] = false\r\n            // if API already returns booleans, this also works:\r\n            else if (typeof v === 'boolean') normalized[f.key] = v\r\n          })\r\n\r\n          normalized.comment_by_examine_doctor = data.comment_by_examine_doctor || ''\r\n\r\n          this.medicalHistory = normalized;\r\n        })\r\n        .catch(err => console.error(err))\r\n        return this.medicalHistory;\r\n    },\r\n    async apiFetchLifestyle({ session_id }) { \r\n        // let lifestyle = {};\r\n        // const baseUrl = cfg.API_BASE_URL;\r\n\r\n        fetch(`${this.baseUrl}/lifestyle/${session_id}`, {\r\n            headers: { Authorization: `Bearer ${localStorage.getItem('jwt_token')}` }\r\n        })\r\n        .then(res => res.json())\r\n        .then(data => {\r\n            this.lifestyle = Array.isArray(data) ? data[0] || {} : data;\r\n        })\r\n        .catch(err => console.error(err));\r\n        return this.lifestyle;\r\n    },\r\n    async apiFetchPE1({ session_id })           { \r\n        // let physicalExam = {};\r\n        // const baseUrl = cfg.API_BASE_URL;\r\n\r\n        fetch(`${this.baseUrl}/physical-exams/${session_id}`, {\r\n            headers: { Authorization: `Bearer ${localStorage.getItem('jwt_token')}` }\r\n        })\r\n        .then(res => res.json())\r\n        .then(data => {\r\n            this.pe1 = Array.isArray(data) ? data[0] || {} : data;\r\n        })\r\n        .catch(err => console.error(err));\r\n        return this.pe1;\r\n    },\r\n    async apiFetchPE2({ session_id }) {\r\n        // let physicalExam2 = {};\r\n        // const baseUrl = cfg.API_BASE_URL;\r\n        fetch(`${this.baseUrl}/physical-exams-2/${session_id}`, {\r\n            headers: { Authorization: `Bearer ${localStorage.getItem('jwt_token')}` }\r\n        })\r\n        .then(res => res.json())\r\n        .then(data => {\r\n            this.pe2 = Array.isArray(data) ? data[0] || {} : data;\r\n        })\r\n        .catch(err => console.error(err));\r\n        return this.pe2;\r\n    },\r\n    async apiFetchLab({ session_id }) {\r\n        // let investigationsLab = {};\r\n        // const baseUrl = cfg.API_BASE_URL;\r\n\r\n        fetch(`${this.baseUrl}/investigations-lab/${session_id}`, {\r\n            headers: { Authorization: `Bearer ${localStorage.getItem('jwt_token')}` }\r\n        })\r\n        .then(r => r.json())\r\n        .then(d => { \r\n        this.lab = Array.isArray(d) ? (d[0] || {}) : d;\r\n        })\r\n        .catch(err => console.error(err));\r\n        return this.lab;\r\n    },\r\n    async apiFetchInvestigations({ session_id }) { \r\n        // let investigations = {};\r\n        // const baseUrl = cfg.API_BASE_URL;\r\n\r\n        fetch(`${this.baseUrl}/investigations/${session_id}`, {\r\n            headers: { Authorization: `Bearer ${localStorage.getItem('jwt_token')}` }\r\n        })\r\n        .then(r => r.json())\r\n        .then(d => { \r\n            this.inv = Array.isArray(d) ? (d[0] || {}) : d; \r\n        })\r\n        .catch(err => console.error(err));\r\n        return this.inv;\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.top { display:flex; align-items:flex-start; gap:16px; justify-content:space-between; margin-bottom:12px; }\r\n.meta { display:flex; gap:20px; opacity:.9; }\r\n.actions { display:flex; gap:8px; }\r\n.status { padding:10px; }\r\n.status.error { color:#b00020; }\r\n</style>\r\n","<template>\r\n  <!-- Trigger -->\r\n  <slot name=\"trigger\" :open=\"open\" :disabled=\"!hasAnyRows\">\r\n    <button :disabled=\"!hasAnyRows\" @click=\"open\">Export Excel (One Sheet)</button>\r\n  </slot>\r\n\r\n  <!-- Dialog -->\r\n  <div v-if=\"show\" class=\"export-backdrop\" @click.self=\"close\">\r\n    <div class=\"export-dialog\">\r\n      <h3>{{ title || 'Export to one Excel sheet' }}</h3>\r\n\r\n      <div class=\"sections\">\r\n        <div\r\n          v-for=\"(sec, i) in normalizedSections\"\r\n          :key=\"sec._id\"\r\n          class=\"sec-card\"\r\n        >\r\n          <div class=\"sec-head\">\r\n            <label class=\"include\">\r\n              <input type=\"checkbox\" v-model=\"state[i].included\" />\r\n              <strong>{{ sec.title }}</strong>\r\n              <span class=\"badge\">{{ sec.kind.toUpperCase() }}</span>\r\n            </label>\r\n          </div>\r\n\r\n          <!-- Column chooser -->\r\n          <details class=\"cols-wrap\" :open=\"normalizedSections.length <= 3\">\r\n            <summary>Columns</summary>\r\n\r\n            <!-- For vertical (key-value) sections, show fields as a single column list -->\r\n            <div v-if=\"sec.kind === 'kv'\" class=\"cols kv\">\r\n              <label\r\n                v-for=\"(col, cIdx) in sec.columns\"\r\n                :key=\"col.key ?? cIdx\"\r\n                class=\"col-item\"\r\n              >\r\n                <input\r\n                  type=\"checkbox\"\r\n                  :value=\"col.key\"\r\n                  v-model=\"state[i].selectedKeys\"\r\n                />\r\n                {{ col.label }}\r\n              </label>\r\n            </div>\r\n\r\n            <!-- For table sections, same selector but just a different visual hint -->\r\n            <div v-else class=\"cols table\">\r\n              <label\r\n                v-for=\"(col, cIdx) in sec.columns\"\r\n                :key=\"col.key ?? cIdx\"\r\n                class=\"col-item\"\r\n              >\r\n                <input\r\n                  type=\"checkbox\"\r\n                  :value=\"col.key\"\r\n                  v-model=\"state[i].selectedKeys\"\r\n                />\r\n                {{ col.label }}\r\n              </label>\r\n            </div>\r\n\r\n            <div class=\"row-actions\">\r\n              <button type=\"button\" @click=\"selectAllCols(i)\">Select all</button>\r\n              <button type=\"button\" @click=\"clearCols(i)\">Clear</button>\r\n            </div>\r\n          </details>\r\n        </div>\r\n      </div>\r\n\r\n      <div class=\"dialog-actions\">\r\n        <button type=\"button\" @click=\"includeAll\">Include all</button>\r\n        <button type=\"button\" @click=\"excludeAll\">Exclude all</button>\r\n        <div class=\"spacer\"></div>\r\n        <button type=\"button\" @click=\"close\">Cancel</button>\r\n        <button type=\"button\" :disabled=\"!canExport\" @click=\"exportNow\">Export</button>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nimport * as XLSX from 'xlsx';\r\n\r\n/**\r\n * OneSheetExport.vue\r\n *\r\n * Props:\r\n *  - sections: Array<{\r\n *        id?: string,\r\n *        title: string,\r\n *        kind: 'kv' | 'table',\r\n *        data: object | any[],                     // object for 'kv', array for 'table'\r\n *        columns: { key, label, getter?, format? }[],\r\n *        defaultSelectedKeys?: string[],           // optional; if omitted, we auto-select all EXCEPT *_at\r\n *    }>\r\n *  - filename?: string\r\n *  - title?: string\r\n *\r\n * Renders all selected sections into a SINGLE Excel sheet.\r\n * 'kv' sections are rendered vertically: Label in col A, Value in col B.\r\n * 'table' sections are rendered as a normal header row followed by rows.\r\n */\r\nexport default {\r\n  name: 'OneSheetExport',\r\n  props: {\r\n    sections: { type: Array, default: () => [] },\r\n    filename: { type: String, default: '' },\r\n    title: { type: String, default: '' },\r\n  },\r\n  data() {\r\n    return {\r\n      show: false,\r\n      state: [], // mirrors sections: [{ included, selectedKeys }]\r\n    };\r\n  },\r\n  computed: {\r\n    normalizedSections() {\r\n      return (Array.isArray(this.sections) ? this.sections : []).map((s, i) => ({\r\n        _id: s.id || `sec-${i}`,\r\n        title: s.title || `Section ${i + 1}`,\r\n        kind: s.kind === 'table' ? 'table' : 'kv',\r\n        data: s.data,\r\n        columns: Array.isArray(s.columns) ? s.columns : [],\r\n        defaultSelectedKeys: Array.isArray(s.defaultSelectedKeys) ? s.defaultSelectedKeys : null,\r\n      }));\r\n    },\r\n    hasAnyRows() {\r\n      return this.normalizedSections.some(s => {\r\n        if (s.kind === 'kv') return !!s.data && typeof s.data === 'object';\r\n        if (s.kind === 'table') return Array.isArray(s.data) && s.data.length > 0;\r\n        return false;\r\n      });\r\n    },\r\n    canExport() {\r\n      return this.normalizedSections.some((s, i) => {\r\n        const st = this.state[i];\r\n        return st?.included && (st.selectedKeys?.length > 0);\r\n      });\r\n    },\r\n  },\r\n  watch: {\r\n    normalizedSections: {\r\n      immediate: true,\r\n      handler(newSecs) {\r\n        this.state = newSecs.map((s) => {\r\n          // Default: include section, select all non-timestamp columns\r\n          const defaultKeys = s.defaultSelectedKeys && s.defaultSelectedKeys.length\r\n            ? [...s.defaultSelectedKeys]\r\n            : s.columns\r\n                .map(c => c.key)\r\n                .filter(k => !(k?.endsWith('created_at') || k?.endsWith('updated_at') || /(^|_)created_at$/.test(k) || /(^|_)updated_at$/.test(k)));\r\n          return {\r\n            included: true,\r\n            selectedKeys: defaultKeys,\r\n          };\r\n        });\r\n      },\r\n    },\r\n  },\r\n  methods: {\r\n    open() { this.show = true; },\r\n    close() { this.show = false; },\r\n\r\n    includeAll() { this.state.forEach(s => (s.included = true)); },\r\n    excludeAll() { this.state.forEach(s => (s.included = false)); },\r\n    selectAllCols(i) {\r\n      const cols = this.normalizedSections[i]?.columns || [];\r\n      this.state[i].selectedKeys = cols.map(c => c.key);\r\n    },\r\n    clearCols(i) { this.state[i].selectedKeys = []; },\r\n\r\n    _valueFor(col, rowOrObj) {\r\n      const raw = col.getter ? col.getter(rowOrObj) : rowOrObj?.[col.key];\r\n      return col.format ? col.format(raw, rowOrObj) : (raw ?? '');\r\n    },\r\n\r\n    exportNow() {\r\n      try {\r\n        const wb = XLSX.utils.book_new();\r\n        const ws = XLSX.utils.aoa_to_sheet([]); // start empty; we’ll add sections\r\n\r\n        let cursor = 0; // current row pointer\r\n\r\n        const addEmptyRow = (n = 1) => { cursor += n; };\r\n\r\n        const addTitle = (text) => {\r\n          XLSX.utils.sheet_add_aoa(ws, [[text]], { origin: { r: cursor, c: 0 } });\r\n          // Bold the title\r\n          const cellAddr = XLSX.utils.encode_cell({ r: cursor, c: 0 });\r\n          if (!ws[cellAddr]) ws[cellAddr] = { t: 's', v: text };\r\n          ws[cellAddr].s = { font: { bold: true } }; // style support varies by writer\r\n          cursor += 1;\r\n        };\r\n\r\n        const addKVSection = (sec, selectedCols) => {\r\n          // Write title\r\n          addTitle(sec.title);\r\n          // Label | Value rows\r\n          const rows = [];\r\n          selectedCols.forEach(col => {\r\n            rows.push([col.label, this._valueFor(col, sec.data)]);\r\n          });\r\n          XLSX.utils.sheet_add_aoa(ws, rows, { origin: { r: cursor, c: 0 } });\r\n          cursor += rows.length;\r\n          addEmptyRow(1);\r\n        };\r\n\r\n        const addTableSection = (sec, selectedCols) => {\r\n          addTitle(sec.title);\r\n          // Header\r\n          const header = selectedCols.map(c => c.label);\r\n          XLSX.utils.sheet_add_aoa(ws, [header], { origin: { r: cursor, c: 0 } });\r\n          cursor += 1;\r\n          // Rows\r\n          const rows = (sec.data || []).map(row => {\r\n            return selectedCols.map(col => this._valueFor(col, row));\r\n          });\r\n          if (rows.length) {\r\n            XLSX.utils.sheet_add_aoa(ws, rows, { origin: { r: cursor, c: 0 } });\r\n            cursor += rows.length;\r\n          }\r\n          addEmptyRow(1);\r\n        };\r\n\r\n        // Render each included section\r\n        this.normalizedSections.forEach((sec, i) => {\r\n          const st = this.state[i];\r\n          if (!st?.included) return;\r\n          const selectedCols = sec.columns.filter(c => st.selectedKeys.includes(c.key));\r\n          if (!selectedCols.length) return;\r\n\r\n          if (sec.kind === 'kv') addKVSection(sec, selectedCols);\r\n          else addTableSection(sec, selectedCols);\r\n        });\r\n\r\n        // (Best-effort) autosize: determine max width per column from worksheet cells\r\n        const ref = ws['!ref'];\r\n        if (ref) {\r\n          const range = XLSX.utils.decode_range(ref);\r\n          const widths = Array.from({ length: range.e.c - range.s.c + 1 }, () => ({ wch: 10 }));\r\n          for (let C = range.s.c; C <= range.e.c; C++) {\r\n            let max = 10;\r\n            for (let R = range.s.r; R <= range.e.r; R++) {\r\n              const cell = ws[XLSX.utils.encode_cell({ r: R, c: C })];\r\n              if (cell && cell.v != null) {\r\n                const len = String(cell.v).length;\r\n                if (len + 2 > max) max = Math.min(len + 2, 60);\r\n              }\r\n            }\r\n            widths[C] = { wch: max };\r\n          }\r\n          ws['!cols'] = widths;\r\n        }\r\n\r\n        XLSX.utils.book_append_sheet(wb, ws, 'Report');\r\n        const name = this.filename || `report-${new Date().toISOString().slice(0,10)}.xlsx`;\r\n        XLSX.writeFile(wb, name);\r\n        this.close();\r\n      } catch (e) {\r\n        console.error('OneSheet export failed:', e);\r\n        alert('Export failed. Check console for details.');\r\n      }\r\n    },\r\n  },\r\n};\r\n</script>\r\n\r\n<style scoped>\r\n.export-backdrop { position: fixed; inset: 0; display: grid; place-items: center; background: rgba(0,0,0,.35); z-index: 9999; }\r\n.export-dialog { background: #fff; width: min(920px, 96vw); max-height: 86vh; overflow: auto; border-radius: 14px; padding: 16px 18px; box-shadow: 0 10px 35px rgba(0,0,0,.25); }\r\n.sections { display: grid; gap: 12px; margin: 10px 0 14px; }\r\n.sec-card { border: 1px solid #e9e9e9; border-radius: 10px; padding: 12px; }\r\n.sec-head { display: flex; align-items: center; gap: 10px; margin-bottom: 6px; }\r\n.include { display: flex; align-items: center; gap: 8px; }\r\n.badge { background: #f2f2f2; border-radius: 999px; padding: 2px 8px; font-size: .75rem; }\r\n.cols-wrap summary { cursor: pointer; margin-bottom: 6px; }\r\n.cols { display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr)); gap: 8px 16px; margin: 6px 0 10px; }\r\n.cols.kv { grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); }\r\n.col-item { display: flex; align-items: center; gap: 8px; }\r\n.row-actions { display: flex; gap: 8px; }\r\n.dialog-actions { display: flex; align-items: center; gap: 8px; }\r\n.dialog-actions .spacer { flex: 1; }\r\n</style>\r\n","import { render } from \"./OneSheetExport.vue?vue&type=template&id=faae8e84&scoped=true\"\nimport script from \"./OneSheetExport.vue?vue&type=script&lang=js\"\nexport * from \"./OneSheetExport.vue?vue&type=script&lang=js\"\n\nimport \"./OneSheetExport.vue?vue&type=style&index=0&id=faae8e84&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-faae8e84\"]])\n\nexport default __exports__","import { render } from \"./ExportMedicalRecord.vue?vue&type=template&id=75502248&scoped=true\"\nimport script from \"./ExportMedicalRecord.vue?vue&type=script&lang=js\"\nexport * from \"./ExportMedicalRecord.vue?vue&type=script&lang=js\"\n\nimport \"./ExportMedicalRecord.vue?vue&type=style&index=0&id=75502248&scoped=true&lang=css\"\n\nimport exportComponent from \"../../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render],['__scopeId',\"data-v-75502248\"]])\n\nexport default __exports__"],"names":["class","_createElementBlock","_hoisted_1","_createElementVNode","style","$data","busy","_hoisted_2","loadError","_hoisted_3","_toDisplayString","_hoisted_4","_cache","_hoisted_5","sessionId","staffEmail","_hoisted_6","disabled","onClick","args","$options","reload","_hoisted_7","$event","_ctx","$router","back","_createVNode","_component_OneSheetExport","ref","sections","filename","title","_renderSlot","$slots","open","hasAnyRows","show","_withModifiers","close","$props","_Fragment","_renderList","normalizedSections","sec","i","key","_id","type","state","included","kind","toUpperCase","length","_hoisted_9","columns","col","cIdx","value","selectedKeys","label","_hoisted_11","_hoisted_13","selectAllCols","_hoisted_14","clearCols","_hoisted_15","_hoisted_16","includeAll","excludeAll","canExport","exportNow","_hoisted_17","name","props","Array","default","String","data","computed","isArray","this","map","s","id","defaultSelectedKeys","some","st","watch","immediate","handler","newSecs","defaultKeys","c","filter","k","endsWith","test","methods","forEach","cols","_valueFor","rowOrObj","raw","getter","format","wb","XLSX","book_new","ws","aoa_to_sheet","cursor","addEmptyRow","n","addTitle","text","sheet_add_aoa","origin","r","cellAddr","encode_cell","t","v","font","bold","addKVSection","selectedCols","rows","push","addTableSection","header","row","includes","range","decode_range","widths","from","e","wch","C","max","R","cell","len","Math","min","book_append_sheet","Date","toISOString","slice","console","error","alert","__exports__","yesNo","fmtDate","components","OneSheetExport","baseUrl","cfg","API_BASE_URL","personalInfo","occupationalRows","familyRows","famDisease","medicalHistory","medicalFields","lifestyle","pe1","pe2","inv","lab","personalInfoCols","occupationalCols","familyCols","famDiseaseCols","medicalCols","lifestyleCols","pe1Cols","pe2Cols","invCols","labCols","created","q","$route","query","session_id","staff_email","mounted","params","apiFetchPersonal","apiFetchOccHistory","apiFetchFamily","apiFetchFamDisease","apiFetchMedicalHistory","apiFetchLifestyle","apiFetchPE1","apiFetchPE2","apiFetchInvestigations","apiFetchLab","$nextTick","$refs","oneSheet","message","staffEmailXYZ","replace","fetch","encodeURIComponent","method","headers","Authorization","localStorage","getItem","then","res","handleUnauthorized","json","catch","err","family_history","Object","keys","normalized","base","f","comment_by_examine_doctor","d","render"],"sourceRoot":""}